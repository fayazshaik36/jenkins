---
- name: Setup Website on web group
  hosts: websrvgrp
  become: yes
  remote_user: devops
  tasks:
   - name: Install httpd
     yum: 
        name: httpd
        state: present

   - name: Start and Enable HTTPD
     service:
        name: httpd
        state: started
        enabled: yes
  
   - name: Push website file
     copy:
       src: index.html
       dest: /var/www/html/
       owner: root
       group: root
       mode: 0644

- name: Setup Mysql db on db group
  hosts: dbsrvgrp
  become: yes
  remote_user: devops
  tasks:
    - name: Install mysql/Mariadb service
      apt:
        name: mysql-server
        state: present

    - name: Install mysql-python
      apt: 
        name: python3-mysqldb
        state: present

   
    - name: Start and Enable Mysql Service
      service: 
        name: mysql 
        state: started 
        enabled: yes

    - name: Create a new database with name 'Accounts'
      mysql_db:
        name: accounts
        state: present

    - name: Setup admin user
      mysql_user:
        name: admin
        password: admin123
        priv: '*.*:ALL'
        state: present

